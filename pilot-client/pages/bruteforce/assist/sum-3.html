<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<link rel='stylesheet' href='../../../plugins/googleapis/fonts.css'>
<link rel="stylesheet" href="../../../dist/css/markdown.css">
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><ul><li><p><strong><span>什么是Token</span></strong></p><p><span>Token全称JSON Web Token，又简称JWT，是一种用于身份验证和授权的开放标准。它是一种轻量级的、基于JSON的令牌，可以在客户端和服务器之间传递信息。JWT由三部分组成：header(头部).payload(载荷).signature(签证)，形似如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51562px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlJvY2siLCJhZG1pbiI6dHJ1ZX0.</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">FgWU4K2h_NpZsfb9FxJcsmKRb3dNNlIgDeuD4onIx4A</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>其中header和payload部分由base64 URL编码进行编码，JWT Signature部分可以使用 HMAC 算法或使用 RSA 的公钥/私钥对进行签名。JWT的优点包括可扩展性、可靠性和安全性。</span></p><p><span>简单的说，JWT就是通过数字签名的方式，以JSON对象为载体的开发标准，可以在不同的服务终端之间安全的传输信息。</span></p><p><span>详细介绍：</span><a href='https://blog.csdn.net/weixin_45070175/article/details/118559272' target="_blank"><span>CSDN-JWT详解</span></a></p></li></ul><p></br></p><ul><li><p><strong><span>Token伪造漏洞</span></strong></p><p><span>Token伪造，顾名思义通过伪造JWT，以特定账户的身份欺骗系统完成验证。Token伪造是一类漏洞的统称，可以是最简单的弱密钥爆破，也可以是其他高危漏洞，但无论类型如何变化，都是基于Token进行攻击并对其身份认证功能产生威胁。常见的关于Token漏洞如下：</span></p><ul><li><p><span>CVE-2015-2951：alg=none签名绕过漏洞</span></p></li><li><p><span>CVE-2016-10555：RS / HS256公钥不匹配漏洞</span></p></li><li><p><span>CVE-2018-0114：Key injection漏洞</span></p></li><li><p><span>CVE-2019-20933 / CVE-2020-28637：Blank password漏洞</span></p></li><li><p><span>CVE-2020-28042：Null signature漏洞</span></p></li><li><p><span>JWKS欺骗</span></p></li><li><p><span>“kid”注射</span></p></li><li><p><span>跨服务中继攻击</span></p></li><li><p><span>弱密钥</span></p></li><li><p><span>……</span></p></li></ul></li></ul><p></br></p><ul><li><p><strong><span>Token测试相关工具</span></strong></p><ol><li><p><span>JWT弱口令爆破：</span><a href='https://github.com/brendan-rius/c-jwt-cracker' target="_blank"><span>jwtcrack</span></a></p></li><li><p><span>JWT综合利用/测试工具：</span><a href='https://github.com/ticarpi/jwt_tool' target="_blank"><span>jwt_tool</span></a></p></li><li><p><span>JWT密钥爆破：</span><a href='https://github.com/hashcat/hashcat' target="_blank"><span>hashcat</span></a></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>Token漏洞防御</span></strong></p><ol><li><p><span>避免在令牌中直接传输用户的敏感数据以及系统内部的关键参数。</span></p></li><li><p><span>若使用对称加密算法，应使用强密钥提高秘钥破解的难度。</span></p></li><li><p><span>若使用非对称加密算法，应在服务端增加已授权算法的白名单，限制签名算法类型，防止密钥混淆攻击。</span></p></li><li><p><span>严格验证并过滤从用户端接收的数据，例如kid、jku等关键参数，防止因没有对参数进行正确校验而产生的安全风险。</span></p></li><li><p><span>在Payload字段中增加一些业务上的字段，用于校验。</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>推荐学习文章</span></strong></p><ol><li><p><a href='https://blog.csdn.net/qq_46081990/article/details/135128438' target="_blank"><span>CSDN-JWT介绍&amp;空加密&amp;暴破密钥&amp;私钥泄露&amp;密钥混淆&amp;黑盒</span></a></p></li><li><p><a href='https://www.cnblogs.com/xiaozi/p/12005929.html' target="_blank"><span>JWT攻击手册</span></a></p></li><li><p><a href='https://xz.aliyun.com/t/12906' target="_blank"><span>先知-JWT渗透姿势一篇通</span></a></p></li></ol></li></ul></div></div>
</body>
</html>