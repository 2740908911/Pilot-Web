<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<link rel='stylesheet' href='../../../plugins/googleapis/fonts.css'>
<link rel="stylesheet" href="../../../dist/css/markdown.css">
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><ul><li><p><strong><span>水平越权漏洞介绍</span></strong></p><p><span>水平越权漏洞是指应用系统在处理同一功能业务时，未对数据和当前用户的权限进行合法性校验，导致用户可越权访问、篡改、删除、添加其他同权限用户的信息，造成越权操作。常见如：访问任意用户订单、修改任意用户密码、删除任意用户信息等。</span></p></li></ul><p></br></p><ul><li><p><strong><span>水平越权漏洞原理</span></strong></p><p><span>应用系统未正确验证用户身份（Cookie、Token等），导致功能接口可以越权访问。本质上为系统鉴权机制的缺陷。</span></p></li></ul><p></br></p><ul><li><p><strong><span>测试方案</span></strong></p><p><span>通过更换的某个 ID 之类的身份标识，从而使 A 账号获取（修改、删除等）B/C/D账号数据（权限相同）。最关键的点就是定位鉴权参数，然后替换为其他账户鉴权参数的方法来发现越权漏洞。</span></p></li></ul><p></br></p><ul><li><p><strong><span>常见工具</span></strong></p><ol><li><p><span>JS接口搜集：</span><a href='https://github.com/momosecurity/FindSomething' target="_blank"><span>浏览器插件-FindSomething</span></a></p></li><li><p><span>WEB接口挖掘：</span><a href='https://github.com/pingc0y/URLFinder' target="_blank"><span>URLFinder</span></a></p></li><li><p><span>越权类测试：</span><a href='https://github.com/Quitten/Autorize' target="_blank"><span>Burp插件-Autorize</span></a></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>漏洞危害</span></strong></p><ol><li><p><span>数据泄露（个人隐私信息、账户相关信息等）</span></p></li><li><p><span>账户安全（通过水平漏洞修改账户信息）</span></p></li><li><p><span>进一步利用</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>水平越权漏洞的防御</span></strong></p><ol><li><p><span>实施严格的访问控制：确保在应用程序的各个层面上实施适当的访问控制机制，包括身份验证、会话管理和授权策略。对用户进行适当的身份验证和授权，仅允许其执行其所需的操作。</span></p></li><li><p><span>验证用户输入：应该对所有用户输入进行严格的验证和过滤，以防止攻击者通过构造恶意输入来利用越权漏洞。特别是对于涉及访问控制的操作，必须仔细验证用户请求的合法性。</span></p></li><li><p><span>最小权限原则：在分配用户权限时，采用最小权限原则，即给予用户所需的最低权限级别，以限制潜在的越权行为。用户只应具备完成其任务所需的最小权限。</span></p></li><li><p><span>安全审计和监控：建立安全审计和监控机制，对系统中的访问活动进行监视和记录。这可以帮助检测和响应越权行为，并提供对事件的审计跟踪。</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>推荐学习文章</span></strong></p><ol><li><p><a href='https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/02.web%E6%BC%8F%E6%B4%9E/26.%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/' target="_blank"><span>d4m1ts知识库-越权漏洞</span></a></p></li><li><p><a href='https://cloud.tencent.com/developer/article/2289815' target="_blank"><span>腾讯社区-详解越权漏洞</span></a></p></li><li><p><a href='https://zhuanlan.zhihu.com/p/516964795' target="_blank"><span>知乎-Web漏洞之越权漏洞</span></a></p></li><li><p><a href='https://xz.aliyun.com/t/11500' target="_blank"><span>先知-未授权、越权类漏洞探究</span></a></p></li></ol></li></ul></div></div>
</body>
</html>