<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<link rel='stylesheet' href='../../../plugins/googleapis/fonts.css'>
<link rel="stylesheet" href="../../../dist/css/markdown.css">
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><ul><li><p><strong><span>未授权访问漏洞介绍</span></strong></p><p><span>未授权访问漏洞是指应用系统对业务功能页面未进行有效的身份校验，在未登录且获知业务功能页面的访问地址前提下，直接访问未授权的页面、目录或资源，获取系统中的敏感信息或进行非法操作。</span></p></li></ul><p></br></p><ul><li><p><strong><span>漏洞分类</span></strong></p><ol><li><p><span>服务/组件中存在未授权。如redis未授权、mongodb未授权等。通常挖掘这种未授权漏洞通过扫描器即可。</span></p></li><li><p><span>WEB应用系统存在未授权。如某CMS未授权文件上传、未授权创建账号等。此类未授权漏洞的发现需要的技巧更高。</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>未授权访问漏洞原理</span></strong></p><p><span>应用系统未正确验证用户身份（Cookie、Token等），导致功能接口可以直接访问到。本质上为系统鉴权机制的缺陷。</span></p></li></ul><p></br></p><ul><li><p><strong><span>测试方案</span></strong></p><ol><li><p><span>通过JS接口挖掘未授权访问漏洞，即寻找接口后通过构造请求方式尝试是否存在未授权访问漏洞。</span></p></li><li><p><span>对正常的请求进行测试，删除掉身份验证信息对接口进行判断是否存在未授权访问。</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>常见工具</span></strong></p><ol><li><p><span>JS接口搜集：</span><a href='https://github.com/momosecurity/FindSomething' target="_blank"><span>浏览器插件-FindSomething</span></a></p></li><li><p><span>WEB接口挖掘：</span><a href='https://github.com/pingc0y/URLFinder' target="_blank"><span>URLFinder</span></a></p></li><li><p><span>越权类测试：</span><a href='https://github.com/Quitten/Autorize' target="_blank"><span>Burp插件-Autorize</span></a></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>漏洞危害</span></strong></p><ol><li><p><span>数据泄露（个人隐私信息、账户相关信息和系统信息等）</span></p></li><li><p><span>账户安全（通过未授权访问漏洞修改账户信息）</span></p></li><li><p><span>系统安全（通过未授权访问可能修改某些应用系统特定功能）</span></p></li><li><p><span>进一步利用</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>未授权访问漏洞的防御</span></strong></p><ol><li><p><span>对于每个功能的访问，需要明确授予特定角色的访问权限。 </span></p></li><li><p><span>如果某功能参与了工作流程，检查并确保当前的条件是授权访问此功能的合适状态。</span></p></li></ol></li></ul><p></br></p><ul><li><p><strong><span>推荐学习文章</span></strong></p><ol><li><p><a href='https://xz.aliyun.com/t/11500' target="_blank"><span>先知-未授权、越权类漏洞探究</span></a></p></li><li><p><a href='https://www.freebuf.com/articles/web/278245.html' target="_blank"><span>Freeebuf-超全面未授权访问漏洞复现合集</span></a></p></li></ol></li></ul></div></div>
</body>
</html>